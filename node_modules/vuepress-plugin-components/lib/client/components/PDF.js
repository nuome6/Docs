import{isDef as b,checkIsiPad as S,checkIsMobile as F,checkIsSafari as L,isLinkHttp as P,ensureEndingSlash as y,entries as D,useLocaleConfig as C}from"@vuepress/helper/client";import{useScrollLock as T}from"@vueuse/core";import{defineComponent as $,shallowRef as E,ref as I,onMounted as R,watch as _,onUnmounted as U,h as d}from"vue";import{CancelFullScreenIcon as k,EnterFullScreenIcon as N}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as z}from"vuepress/client";import{u as H}from"../useSize-C8GaR9if.js";import{g as M}from"../getLink-DBmDl_2w.js";const p=e=>{console.error(`[PDF]: ${e}`)},j=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},B=e=>e instanceof HTMLElement?e:e==="string"?document.querySelector(e):document.body,J=e=>{let t=D(e).map(([o,r])=>o==="noToolbar"?`toolbar=${r?"0":"1"}`:`${encodeURIComponent(o)}=${encodeURIComponent(r)}`).join("&");return t&&(t=`#${t.slice(0,t.length-1)}`),t},g=(e,t,o,r,l)=>{j(t);const u=`${e==="pdfjs"?`${y(z(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(o)}`:o}${J(r)}`,i=e==="pdfjs"||e==="iframe"?"iframe":"embed",n=document.createElement(i);return n.className="pdf-viewer",n.type="application/pdf",n.title=l,n.src=u,n instanceof HTMLIFrameElement&&(n.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(n),t.getElementsByTagName(i)[0]},x=(e,t,{title:o,hint:r,options:l={},force:u})=>{if(typeof window>"u"||!window?.navigator?.userAgent)return null;const{navigator:i}=window,{userAgent:n}=i,c=b(window.Promise),a=S(n)||F(n),w=!a&&L(n),h=!a&&/firefox/iu.test(n)&&n.split("rv:").length>1?parseInt(n.split("rv:")[1].split(".")[0],10)>18:!1,v=!a&&(c||h),f=P(e)?e:__VUEPRESS_DEV__?null:`${window.origin}${e}`;if(!f)return p("PDF link is not accessible."),null;const s=B(t);if(!s)return p("Target element cannot be determined"),null;const m=(o||/\/([^/]+).pdf/.exec(f)?.[1])??"PDF Viewer";return u?PDFJS_URL?g("pdfjs",s,e,l,m):(s.innerHTML=r.replace(/\[url\]/g,f),p("PDFJS URL is not defined"),null):v||!a?g(w?"iframe":"embed",s,e,l,m):PDFJS_URL?g("pdfjs",s,e,l,m):(s.innerHTML=r.replace(/\[url\]/g,e),p("This browser does not support embedded PDFs"),null)};var A=$({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:{type:[String,Number],default:100},viewer:Boolean},setup(e){const{el:t,width:o,height:r,resize:l}=H(e),u=C(PDF_LOCALES),i=E(),n=I(!1);return R(()=>{x(M(e.url),i.value,{title:e.title,hint:u.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom.toString()==="100"?{}:{zoom:e.zoom}},force:e.viewer}),l();const c=T(document.body);_(n,a=>{c.value=a}),U(()=>{c.value=!1})}),()=>d("div",{class:["pdf-viewer-wrapper",{fullscreen:n.value}],ref:t,style:n.value?{}:{width:o.value,height:r.value}},[d("div",{ref:i}),e.noFullscreen?null:d("button",{class:"pdf-fullscreen-button",onClick:()=>{n.value=!n.value}},d(n.value?k:N,{class:"pdf-fullscreen-icon"}))])}});export{A as default};
//# sourceMappingURL=PDF.js.map
