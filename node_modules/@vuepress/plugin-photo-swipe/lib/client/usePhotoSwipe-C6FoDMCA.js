import{isFunction as H,useLocaleConfig as L,isString as D,isArray as M}from"@vuepress/helper/client";import{useFullscreen as O,useEventListener as x}from"@vueuse/core";import{ref as z,isRef as F,watch as k,computed as I,inject as V,onMounted as B,onUnmounted as R}from"vue";import{usePageFrontmatter as j}from"vuepress/client";import"photoswipe/dist/photoswipe.css";import"./styles/photo-swipe.css";const m=z({}),_=Symbol(__VUEPRESS_DEV__?"photoswipe":""),G=e=>{F(e)?k(()=>e.value,o=>{m.value=o},{immediate:!0}):H(e)?k(I(e),o=>{m.value=o}):m.value=e},b=()=>V(_),U=e=>{e.provide(_,m)},p=e=>new Promise((o,r)=>{e.complete?o({type:"image",element:e,src:e.src,width:e.naturalWidth,height:e.naturalHeight,alt:e.alt,msrc:e.src}):(e.onload=()=>{o(p(e))},e.onerror=()=>{r()})}),Z=e=>new Promise((o,r)=>{const t=new Image;t.src=e,t.onload=()=>{o(p(t))},t.onerror=()=>{r()}}),T='<div class="photo-swipe-loading"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div>',A=(e,{download:o=!0,fullscreen:r=!0}={})=>{e.on("uiRegister",()=>{if(e.ui.registerElement({name:"bulletsIndicator",className:"photo-swipe-bullets-indicator",appendTo:"wrapper",onInit:t=>{const n=[];let l=-1;for(let u=0;u<e.getNumItems();u++){const a=document.createElement("div");a.className="photo-swipe-bullet",a.onclick=c=>{e.goTo(n.indexOf(c.target))},n.push(a),t.appendChild(a)}e.on("change",()=>{l>=0&&n[l].classList.remove("active"),n[e.currIndex].classList.add("active"),l=e.currIndex})}}),r){const{isSupported:t,toggle:n}=O();t.value&&e.ui.registerElement({name:"fullscreen",order:7,isButton:!0,html:'<svg class="pswp__icn" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M249.5 270.833H437v-75H212a37.5 37.5 0 0 0-37.5 37.5v225h75v-187.5zm-37.5 600h225v-75H249.5v-187.5h-75v225a37.5 37.5 0 0 0 37.5 37.5zm637.5-37.5v-225h-75v187.5H587v75h225a37.5 37.5 0 0 0 37.5-37.5zM587 270.833h187.5v187.5h75v-225a37.5 37.5 0 0 0-37.5-37.5H587v75z"/></svg>',onClick:()=>{n()}})}o&&e.ui.registerElement({name:"download",order:8,isButton:!0,tagName:"a",html:{isCustomSVG:!0,inner:'<path d="M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1-1.5-1.6ZM23 23H9v2h14" id="pswp__icn-download"/>',outlineID:"pswp__icn-download"},onInit:t=>{t.setAttribute("download",""),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener"),e.on("change",()=>{t.setAttribute("href",e.currSlide.data.src)})}})})},q=({selector:e,locales:o,download:r=!0,fullscreen:t=!0,scrollToClose:n=!0})=>{const l=b(),u=L(o),a=j(),c=I(()=>{const{photoSwipe:d}=a.value;return d===!1?null:D(d)?d:M(e)?e.join(", "):e}),S=I(()=>({...l.value,...u.value,download:r,fullscreen:t,scrollToClose:n}));let h=0,s=null;const E=async d=>{const v=d.target;if(c.value&&v.matches(c.value)){s?.destroy();const{default:N}=await import("photoswipe"),w=Array.from(document.querySelectorAll(c.value)),f=w.findIndex(i=>i===v),g=w.map(i=>({html:T,element:i,msrc:i.src}));g.splice(f,1,await p(v));const C=Date.now();h=C,s=new N({preloaderDelay:0,showHideAnimationType:"zoom",...S,dataSource:g,index:f,...n?{closeOnVerticalDrag:!0,wheelToZoom:!1}:{}}),A(s,{download:r,fullscreen:t}),s.init(),s.on("destroy",()=>{s=null,h=0}),w.forEach((i,y)=>{y===f||h!==C||p(i).then(P=>{g.splice(y,1,P),s?.refreshSlideContent(y)})})}};B(()=>{x("click",E),x("wheel",()=>{S.value.scrollToClose&&s?.close()})}),R(()=>{s?.destroy()})};export{T as L,b as a,G as d,U as i,Z as r,A as s,q as u};
//# sourceMappingURL=usePhotoSwipe-C6FoDMCA.js.map
